---
title: "Relatório Final"
author: "Brenno Cordeiro"
date: "June 11, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(viridis)

transito <- read_csv("tabela1.csv")
transito2 <- read_csv("tabela2.csv")
```

# Relatório Final

%% METODOLOGIA 
% problemas
% perguntar o local
% distância
% avaliacao do metro e onibus

## Objetivo Geral
Analisar e estudar os efeitos, caso existam, do tempo gasto no deslocamento até a instituição de ensino no tempo disponível para os estudos

## Meios de transporte
Para começar a verificar a relação dos alunos da aula de estatística exploratória com o trânsito, podemos primeiro olhar para o meio de transporte.

```{r, echo=FALSE}
transito %>%
  gather(ida_transporte, volta_transporte, key=tipo, value=Meio) %>% 
  group_by(Meio) %>% 
  summarise(Ida = sum(tipo == 'ida_transporte'), Volta = sum(tipo == 'volta_transporte'))
```

A maior parte dos alunos usa carro ou ônibus no seu deslocamento diário. Para chegar até a universidade, mais alunos preferem utilizar carro ao ônibus, situação que se inverte na volta. 

```{r, include=FALSE, echo=FALSE}
transito %>%
  mutate(resid = ifelse( resid %in% c('Asa Norte', 'Asa Sul'), 'Brasília', resid),
         resid = ifelse( resid %in% c('Brasília', 'Taguatinga', 'São Sebastião'), resid, 'Outros'),
         ida_transporte = ifelse( ida_transporte %in% c('A pé', 'Bicicleta'), "A pé ou Bicicleta", ida_transporte)) %>%
  group_by(ida_transporte, resid) %>% 
  summarise(n = n()) %>% 
  ggplot() +
    geom_point(aes(ida_transporte, resid, size = n, color = n)) + 
    scale_color_viridis()
```
```{r, echo=FALSE}
transito2 %>%
  mutate(resid = ifelse( resid %in% c('Asa Norte', 'Asa Sul'), 'Brasília', resid),
         resid = ifelse( resid %in% c('Brasília', 'Taguatinga', 'São Sebastião'), resid, 'Outros')) %>%
  group_by(meio, resid) %>% 
  summarise(n = n()) %>% 
  ggplot() +
    geom_point(aes(meio, resid, size = n, color = n)) + 
    scale_color_viridis()
```
Analisando os meios de transporte por área de residência, encontramos associações interessantes. Como era de se esperar, as pessoas que responderam que vão ou voltam a pé ou de bicicleta, moram em Brasília, ou seja, perto da universidade. Já para os usuários de metrô, 62% moram em Taguatinga. %Incluir mais analise

```{r, echo=FALSE}
transito %>% 
  mutate(dist = ifelse(dist == 10.8, 5, dist)) %>% 
  group_by(volta_transporte) %>% 
  summarise(dist_media = mean(dist))
```

Com relação às distâncias, pode-se observar uma maior distância média dos usuários de transporte público de sua residência à universidade. Entretanto, verificar a distância média pode esconder informações, já que a média não representa todos os dados e é afetada por valores extremos. Considerando apenas os meios de transporte mais utilizados, encontramos mais informações.

```{r, echo=FALSE}
transito %>% 
  gather(ida_transporte, volta_transporte, key = tipo, value = meio) %>% 
  filter(meio %in% c("Ônibus", "Metrô", "Carro")) %>% 
  mutate(dist = ifelse(dist == 10.8, 5, dist)) %>% 
  ggplot() + 
    geom_boxplot(aes(reorder(meio, dist, FUN = median ), dist)) +
    facet_wrap(~ tipo)
```
Encontramos uma alta variabilidade da distância nos dados referentes ao uso de carro e ônibus tanto na ida quanto na volta. Vale ressaltar que na observação dos gráfico pode-se notar que grande parte das pessoas usam o mesmo meio de transporte no seu trajeto diário à universidade.


```{r, echo=FALSE}
transito$avaliacao <- as_factor(transito$avaliacao)
transito$avaliacao <- factor(transito$avaliacao, levels = c('Muito ruim', 'Ruim', 'Regular', 'Bom', 'Muito bom'))
```

```{r, echo=FALSE}
transito %>%
  filter(is.na(avaliacao) != TRUE) %>% 
  ggplot(aes(avaliacao)) +
    geom_bar(aes(fill = avaliacao))
```
Em relação à qualidade do transporte público, podemos ver que a avaliação dos estudantes apresenta uma distribuição simétrica, com maior frequência da avaliação **regular** e menor frequência das avaliações extremas. 

```{r, echo=FALSE}
transito %>% 
  filter(ida_transporte == "Metrô" | volta_transporte == "Metrô") %>% 
  group_by(avaliacao) %>% 
  summarise(n())
```
Se considerarmos apenas os usuários de metrô, a distribuição se torna diferente. Não ouveram respostas no extremos, e mais pessoas responderam "Bom" do que "Ruim", o que nos leva a acreditar que o metrô se encontra em boa qualidade.

## Tempo no Trânsito

```{r, include=FALSE}
transito_tempo <- transito %>%
     mutate(tempo = ida_tempo + volta_tempo) %>% 
     pull(tempo)
```

```{r, echo=FALSE}
transito %>% 
  select(ida_tempo, volta_tempo) %>% 
  mutate(transito_tempo = (ida_tempo + volta_tempo)) %>% 
  gather(`ida_tempo`, `volta_tempo`, key=tipo, value=tempo) %>% 
  ggplot() +
    geom_boxplot(aes(tipo, tempo))
```

A partir do gráfico 1*, podemos comparar a distribuição de dois conjuntos de dados: o tempo médio que os estudante levam até chegar na universidade, e o tempo médio que levam para chegar no local de interesse após a saída da universidade. No primeiro conjunto, podemos verificar uma simetria e uma menor variabilidade se comparada ao segundo conjunto. De fato, se levarmos em conta a medida do coeficiente de variação, obtemos um valor de 0.52 para o primeiro conjunto, e 0.56. A diferença é sútil, mas nos mostra também que ambos conjuntos são heterogêneos. Podemos verificar ainda a existência valores extremos no segundo conjunto de dados, como indício da maior variância. % TODO Perguntar isso pra prof ou pro monitor

Analisando mais a fundo os quartis do nosso conjunto de dados, podemos verificar que metade dos alunos precisam de pelo menos 50 minutos para chegar a universidade. Para 25% dos alunos, esse valor é de pelo menos 1 hora e 15 minutos.
Para sair da universidade, metade dos nossos alunos levam mais de 1 hora para chegar no seu local de interesse. No geral, em média, o aluno da UnB passa 1 hora e 50 minutos no trânsito diariamente e o tempo .



